<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Baraka Community & Family Centre</title>
  <meta name="description" content="Baraka Community & Family Centre — a SCIO in West Glasgow supporting young people, women, families, and refugees to thrive." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --brand: #0ea5e9;
      --brand-dark: #0369a1;
      --accent: #22c55e;
      --ink: #0f172a;
      --muted: #475569;
      --bg: #EAF7F1;          /* page background (light green) */
      --card: #EAF7F1;        /* tinted card bg; JS may override */
      --card-border: #d1e7dd; /* tinted card border; JS may override */
      --ring: rgba(14,165,233,.35);
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: var(--ink); background: var(--bg); }
    a { color: var(--brand-dark); text-decoration: none; }
    a.btn { display: inline-block; padding: 12px 18px; border-radius: 12px; font-weight: 600; background: var(--brand); color: #fff; box-shadow: 0 6px 16px rgba(2,132,199,.25); transition: transform .05s ease; }
    a.btn:hover { transform: translateY(-1px); filter: brightness(0.95); }
    a.btn.secondary { background: var(--accent); box-shadow: 0 6px 16px rgba(34,197,94,.25); }
    header { position: sticky; top: 0; z-index: 50; backdrop-filter: blur(8px); background: rgba(248,250,252,.85); border-bottom: 1px solid #e2e8f0; }
    .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
    .nav { display: flex; align-items: center; justify-content: space-between; height: 64px; }
    .logo { display: flex; align-items: center; gap: 10px; font-weight: 800; letter-spacing:.2px; }
    .logo img { width: 36px; height: 36px; border-radius: 8px; object-fit: cover; background: #e2e8f0; }
    .nav a { margin-left: 18px; color: var(--muted); font-weight: 600; }
    .nav a:hover { color: var(--ink); }
    .hero { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 28px; padding: 64px 0 32px; align-items: center; }
    .hero h1 { font-size: clamp(28px, 5vw, 44px); line-height: 1.1; margin: 0 0 14px; }
    .eyebrow { display:inline-block; padding: 6px 10px; border-radius: 999px; background: #e0f2fe; color: #075985; font-weight: 700; font-size: 12px; letter-spacing: .3px; text-transform: uppercase; }
    .lead { color: var(--muted); font-size: 18px; }
    .hero-card { background: var(--card); border: 1px solid var(--card-border); border-radius: 18px; padding: 20px; box-shadow: 0 10px 30px rgba(15,23,42,.06); }
    .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; margin-top: 18px; }
    .stat { background: var(--card); border: 1px solid var(--card-border); border-radius: 14px; padding: 14px; text-align:center; }
    .stat h3{ margin:0; font-size: 24px; }
    section { padding: 36px 0; }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 18px; }
    .card { background: var(--card); border: 1px solid var(--card-border); border-radius: 18px; padding: 18px; box-shadow: 0 10px 30px rgba(15,23,42,.06); }
    .card h3 { margin: 0 0 8px; }
    .card p { color: var(--muted); }
    .kicker { color: var(--muted); font-weight: 700; text-transform: uppercase; letter-spacing: .3px; margin-bottom: 8px; font-size: 12px; }
    .section-title { font-size: 28px; margin: 0 0 12px; }
    .program li { margin: 8px 0; }
    .cta { text-align: center; padding: 40px 18px; background: var(--card); border: 1px solid var(--card-border); border-radius: 20px; }
    .two { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; }
    form input, form textarea, form select { width: 100%; padding: 12px 14px; border-radius: 12px; border: 1px solid #cbd5e1; outline: none; font: inherit; }
    form input:focus, form textarea:focus, form select:focus { border-color: var(--brand); box-shadow: 0 0 0 4px var(--ring); }
    form button { padding: 12px 16px; border-radius: 12px; border: 0; background: var(--brand); color:#fff; font-weight:700; cursor:pointer; }
    .footer { padding: 28px 0 40px; color: var(--muted); font-size: 14px; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; background:#f1f5f9; color:#0f172a; font-weight:600; font-size:12px; }
    .donate-row { display:flex; flex-wrap:wrap; gap:12px; }
    .notice { font-size: 13px; color:#64748b; }
    .oscr { display:flex; align-items:center; gap:10px; }
    .prog-img { width: 100%; height: 160px; object-fit: cover; border-radius: 12px; margin-bottom: 8px; }
    .gallery { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .gimg { background: var(--card); border: 1px solid var(--card-border); border-radius: 14px; padding: 8px; }
    .gimg img { width: 100%; height: 200px; object-fit: cover; border-radius: 10px; }
    .gimg figcaption { font-size: 12px; color: var(--muted); margin-top: 6px; }
    @media (max-width: 900px) {
      .hero { grid-template-columns: 1fr; }
      .grid { grid-template-columns: 1fr; }
      .two { grid-template-columns: 1fr; }
      .gallery { grid-template-columns: 1fr; }
    }
    details#tests { margin: 24px auto; max-width: 1100px; }
    details#tests summary { cursor: pointer; font-weight: 700; }
    details#tests pre { background:#0b1220; color:#d1e7ff; padding:12px; border-radius:8px; overflow:auto; }
  

    /* --- Bigger header (scalable) --- */
:root { --header-scale: 1.25; }  /* try 1.15–1.35 */

header .nav { height: calc(64px * var(--header-scale)); }
.logo img   { width:  calc(36px * var(--header-scale));
              height: calc(36px * var(--header-scale)); }

/* site name and menu links scale up too */
#siteName { font-size: calc(1rem * var(--header-scale)); }
.nav a    { font-size: calc(0.95rem * var(--header-scale));
            margin-left: calc(18px * var(--header-scale)); }

/* keep it comfortable on phones */
@media (max-width: 900px) {
  :root { --header-scale: 1.10; }
  .nav a { margin-left: 14px; }
}

  
  
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="logo">
        <img id="logo" src="assets/baraka-logo.png" alt="Baraka logo" />
        <span id="siteName">Baraka Community & Family Centre</span>
      </div>
      <nav>
        <a href="#about">About</a>
        <a href="#programmes">Programmes</a>
        <a href="#get-involved">Get involved</a>
        <a href="#news">News</a>
        <a href="#donate" class="pill">Donate</a>
        <a href="#gallery">Photos</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero" id="home">
      <div id="heroLeft"></div>
      <div id="heroRight" class="hero-card"></div>
    </section>

    <section id="about"></section>
    <section id="programmes"></section>
    <section id="get-involved"></section>
    <section id="news"></section>
    <section id="donate"></section>
    <section id="gallery"></section>
    <section id="contact"></section>
  </main>

  <footer class="footer">
    <div class="container" style="display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:space-between;">
      <div>© <span id="year"></span> <span id="footerName">Baraka Community & Family Centre</span> · All rights reserved.<br><span class="notice">Registered SCIO <span id="scio"></span></span></div>
      <div class="oscr"><img id="oscrBadge" src="assets/oscr-badge.jpg" alt="OSCR badge" style="height:40px;border-radius:6px;"/></div>
    </div>
  </footer>

  <!-- Default content as JSON so you can edit /data/content.json without touching code -->
  <script id="default-content" type="application/json">
  {
    "site": {
      "name": "Baraka Community & Family Centre",
      "logo": "assets/baraka-logo.png",
      "brand": { "primary": "#6B3F18", "accent": "#22C55E", "bg": "#EAF7F1" }
    },
    "hero": {
      "eyebrow": "Scottish Charitable Incorporated Organisation (SCIO)",
      "title": "Safe spaces, practical support, and community for families in West Glasgow.",
      "lead": "Created by people with lived experience of seeking asylum, Baraka helps young people, women, families, and refugees thrive socially, emotionally, and economically.",
      "image": "assets/baraka-logo.png",
      "image_alt": "Community photo",
      "actions": [
        {"label":"Donate","href":"#donate"},
        {"label":"Volunteer","href":"#get-involved","style":"secondary"}
      ],
      "stats": [
        {"value":"4+","label":"Active programmes"},
        {"value":"2024–25","label":"Lottery & Corra funded"},
        {"value":"Weekly","label":"Food distribution"}
      ],
      "right_kicker":"This month",
      "right_title":"What’s on at Baraka",
      "this_month":[
        "Family Connection Hub — Saturdays, community activities for parents & kids.",
        "Digital Hub — weekly sessions for parents and youths.",
        "Wellness Hub — peer support & wellbeing cafés.",
        "Food Distribution — weekly with FareShare."
      ],
      "right_note":"Want to join? "
    },
    "about": {
      "title": "Our story & mission",
      "story": "Baraka Community & Family Centre is a SCIO based in West Glasgow, created by individuals from Black and Ethnic Minority (BAMER) backgrounds who came to the UK as asylum seekers.",
      "values": "We provide culturally sensitive, community-led services built on empathy, dignity, solidarity, and empowerment.",
      "bullets": [
        "Mission: Support young people, women, families, and refugees to thrive through safe spaces, inclusive services, and access to opportunities.",
        "Funding: Supported by The National Lottery Community Fund and Corra Foundation; with monthly support from Scottish Sadaqah (distributed per Zakat principles)."
      ],
      "values_title": "Empathy • Dignity • Solidarity • Empowerment",
      "values_para": "Our programmes are co-designed with participants. Lived experience informs everything from outreach to facilitation.",
      "cta_title": "Need support?",
      "cta_note": "We’ll listen and connect you to the right activity or service.",
      "cta_label": "Get in touch",
      "cta_href": "#contact"
    },
    "programmes_title":"What we run",
    "programmes": [
      {"title":"Family Connection Hub","description":"Monthly family activities to build confidence, connection, and joy for parents and children.","image":"assets/baraka-logo.png","image_alt":"Family activities","bullets":["Group activities and creative play","Peer support and signposting","Open to families across West Glasgow"]},
      {"title":"Digital Hub","description":"Weekly digital skills sessions for parents and youths to boost confidence and employability.","image":"assets/baraka-logo.png","image_alt":"Digital skills","bullets":["Basic to intermediate digital skills","CV, job search & online safety","Device support available"]},
      {"title":"Wellness Hub","description":"Peer-led wellbeing cafés and support circles focused on mental health, connection, and resilience.","image":"assets/baraka-logo.png","image_alt":"Wellbeing","bullets":["Women’s Wellbeing Café (monthly)","Support circles (domestic-abuse-informed)"]},
      {"title":"Food Distribution Service","description":"Weekly food support in partnership with FareShare, prioritising families and refugees in need.","image":"assets/baraka-logo.png","image_alt":"Food distribution","bullets":["Fresh & ambient foods","Volunteer-led distribution","Fair, dignified access"]},
      {"title":"Baraka Thrive","description":"Family well-being and empowerment activities—from parenting workshops to community events.","image":"assets/baraka-logo.png","image_alt":"Baraka Thrive"},
      {"title":"EmpowerHer (Women)","description":"Sewing & crochet workshops; support circles for women affected by domestic abuse; signposting.","image":"assets/baraka-logo.png","image_alt":"EmpowerHer"}
    ],
    "get_involved": {
      "title":"Volunteer or partner with us",
      "volunteer": {"intro":"We welcome friendly volunteers for activities, mentoring, logistics, and translation.","roles":["Food distribution","Family activities","Digital skills","Wellbeing support","Other"],"email":"hello@baraka-centre.org"},
      "partner": {"intro":"We work with schools, faith groups, and local services. Refer a family or propose a joint activity.","email":"hello@baraka-centre.org","note":"We are based in West Glasgow. Meetings by appointment."}
    },
    "news_title": "Latest news",
    "news": [
      {"title":"New: Weekly Food Collection","body":"We’ve partnered with FareShare to distribute surplus food to local families. Volunteers welcome!","date":"1 Aug 2025"},
      {"title":"EmpowerHer Workshops","body":"Sewing and crochet sessions are open for registration. Child-friendly space available.","date":"20 Jul 2025"},
      {"title":"Grants & Support","body":"Thanks to The National Lottery Community Fund, Corra Foundation, and Scottish Sadaqah.","date":"10 Jun 2025"}
    ],
    "donate_title":"Support our work",
    "donate": {"intro":"Your donation helps us run weekly food support, skills workshops, and safe community spaces.","paypal":"","stripe":"","justgiving":"","note":"Baraka Community & Family Centre is a registered Scottish charity (SCIO). Gift Aid where eligible."},
    "gallery": { "title":"Photos", "subtitle":"A glimpse of life at Baraka", "images": [] },
    "contact_title":"Get in touch",
    "contact": {"email":"hello@baraka-centre.org","visit_note":"West Glasgow (meetings by appointment). Exact address shared upon confirmation for safeguarding.","socials":{"facebook":"#","instagram":"#","whatsapp":"#"},"map_embed":""},
    "legal": {"scio":"SC052268","oscr_badge":"assets/oscr-badge.jpg"}
  }
  </script>

  <details id="tests"><summary>Developer tests (click to open)</summary>
    <pre id="test-log">Running…</pre>
  </details>

  <script>
    const tlog = document.getElementById('test-log');
    const results = [];
    function assert(name, cond){ results.push((cond? '✔︎ ':'✘ ') + name); }
    function finish(){ tlog.textContent = results.join('\n'); }
    const esc = (s) => String(s ?? '').replace(/[&<>\"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
    function parseDefault(){ try { return JSON.parse(document.getElementById('default-content').textContent); } catch(e){ return {}; } }
    const HEX = (n) => n.toString(16).padStart(2,'0');
    function hexToRgb(h){ const m = /^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(h||''); return m?{r:parseInt(m[1],16),g:parseInt(m[2],16),b:parseInt(m[3],16)}:{r:255,g:255,b:255}; }
    function mix(a,b,t){ const A=hexToRgb(a),B=hexToRgb(b); const r=Math.round(A.r*(1-t)+B.r*t), g=Math.round(A.g*(1-t)+B.g*t), b2=Math.round(A.b*(1-t)+B.b*t); return `#${HEX(r)}${HEX(g)}${HEX(b2)}`; }

    async function loadContent(){
      const fallback = parseDefault();
      try {
        const res = await fetch('data/content.json', {cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        const data = await res.json();
        renderSite(data);
      } catch(e){
        renderSite(fallback);
      }
    }

    function applyBrand(brand={}){
      const root = document.documentElement;
      const primary = brand.primary || getComputedStyle(root).getPropertyValue('--brand').trim() || '#6B3F18';
      const accent  = brand.accent  || getComputedStyle(root).getPropertyValue('--accent').trim() || '#22C55E';
      const bg      = brand.bg      || getComputedStyle(root).getPropertyValue('--bg').trim()     || '#EAF7F1';
      root.style.setProperty('--brand', primary);
      root.style.setProperty('--brand-dark', primary);
      root.style.setProperty('--accent', accent);
      root.style.setProperty('--bg', bg);
      const card   = mix(bg, accent, 0.08);
      const border = mix(card, accent, 0.15);
      root.style.setProperty('--card', card);
      root.style.setProperty('--card-border', border);
    }

    function renderSite(d){
      applyBrand(d.site && d.site.brand || {});
      if(d.site?.name) document.getElementById('siteName').textContent = d.site.name;
      if(d.site?.logo) document.getElementById('logo').src = d.site.logo;

      const heroL = document.getElementById('heroLeft');
      const eyebrow = d.hero?.eyebrow ? `<span class=\"eyebrow\">${esc(d.hero.eyebrow)}</span>` : '';
      const actions = (d.hero?.actions||[]).map(a=>`<a class=\"btn ${a.style==='secondary'?'secondary':''}\" href=\"${esc(a.href)}\">${esc(a.label)}</a>`).join(' ');
      const stats = (d.hero?.stats||[]).map(s=>`<div class=\"stat\"><h3>${esc(s.value)}</h3><div class=\"notice\">${esc(s.label)}</div></div>`).join('');
      heroL.innerHTML = `
        ${eyebrow}
        <h1>${esc(d.hero?.title)}</h1>
        <p class=\"lead\">${esc(d.hero?.lead)}</p>
        <div style=\"display:flex; gap:12px; margin-top:18px; flex-wrap:wrap;\">${actions} <a href=\"#programmes\" style=\"align-self:center; font-weight:700;\">See our programmes →</a></div>
        <div class=\"stats\">${stats}</div>
      `;

      const heroR = document.getElementById('heroRight');
      const heroImg = d.hero?.image ? `<img src=\"${esc(d.hero.image)}\" alt=\"${esc(d.hero.image_alt||'Photo')}\" loading=\"lazy\" style=\"width:100%;border-radius:12px;margin-bottom:10px;\"/>` : '';
      const items = (d.hero?.this_month||[]).map(i=>`<li>${esc(i)}</li>`).join('');
      heroR.innerHTML = `
        ${heroImg}
        <div class=\"kicker\">${esc(d.hero?.right_kicker || 'This month')}</div>
        <h3 style=\"margin:6px 0 10px;\">${esc(d.hero?.right_title || 'What’s on at Baraka')}</h3>
        <ul style=\"margin:0; padding-left:18px; color:var(--muted); line-height:1.6;\">${items}</ul>
        <p class=\"notice\" style=\"margin-top:12px;\">${d.hero?.right_note ? esc(d.hero.right_note) : 'Want to join? '}<a href=\"#contact\">Contact us</a> to check times and locations.</p>
      `;

      const about = document.getElementById('about');
      const bullets = (d.about?.bullets||[]).map(b=>`<li>${esc(b)}</li>`).join('');
      about.innerHTML = `
        <div class=\"two\">
          <div class=\"card\">
            <div class=\"kicker\">About us</div>
            <h2 class=\"section-title\">${esc(d.about?.title || 'Our story & mission')}</h2>
            <p>${esc(d.about?.story)}</p>
            <p>${esc(d.about?.values)}</p>
            <ul>${bullets}</ul>
          </div>
          <div class=\"card\">
            <div class=\"kicker\">What we value</div>
            <h2 class=\"section-title\">${esc(d.about?.values_title || 'Empathy • Dignity • Solidarity • Empowerment')}</h2>
            <p>${esc(d.about?.values_para)}</p>
            <div class=\"cta\" style=\"margin-top:10px;\">
              <h3 style=\"margin:0 0 6px;\">${esc(d.about?.cta_title || 'Need support?')}</h3>
              <p class=\"notice\" style=\"margin:0 0 10px;\">${esc(d.about?.cta_note || 'We’ll listen and connect you to the right activity or service.')}</p>
              <a href=\"${esc(d.about?.cta_href || '#contact')}\" class=\"btn\">${esc(d.about?.cta_label || 'Get in touch')}</a>
            </div>
          </div>
        </div>`;

      const programmes = document.getElementById('programmes');
      const cards = (d.programmes||[]).map(p=>`
        <div class=\"card program\">
          ${p.image?`<img class=\\\"prog-img\\\" src=\\\"${esc(p.image)}\\\" alt=\\\"${esc(p.image_alt||p.title||'Programme image')}\\\" loading=\\\"lazy\\\"/>`:''}
          <h3>${esc(p.title)}</h3>
          <p>${esc(p.description||'')}</p>
          ${p.bullets?`<ul>${p.bullets.map(li=>`<li>${esc(li)}</li>`).join('')}</ul>`:''}
        </div>
      `).join('');
      programmes.innerHTML = `
        <div class=\"kicker\">Programmes</div>
        <h2 class=\"section-title\">${esc(d.programmes_title || 'What we run')}</h2>
        <div class=\"grid\">${cards}</div>`;

      const gi = document.getElementById('get-involved');
      const roleOptions = (d.get_involved?.volunteer?.roles || []).map(r=>`<option>${esc(r)}</option>`).join('');
      const volunteerEmail = esc(d.get_involved?.volunteer?.email || d.contact?.email || '');
      const partnerEmail = esc(d.get_involved?.partner?.email || d.contact?.email || '');
      gi.innerHTML = `
        <div class=\"kicker\">Get involved</div>
        <h2 class=\"section-title\">${esc(d.get_involved?.title || 'Volunteer or partner with us')}</h2>
        <div class=\"two\">
          <div class=\"card\">
            <h3>Volunteer</h3>
            <p>${esc(d.get_involved?.volunteer?.intro || 'We welcome friendly volunteers for activities, mentoring, logistics, and translation.')}</p>
            <form action=\\\"mailto:${volunteerEmail}\\\" method=\\\"post\\\" enctype=\\\"text/plain\\\" onsubmit=\\\"alert('Thank you! We\\\\'ll be in touch.');\\\">
              <div class=\"two\">
                <div><label class=\"notice\">Name</label><input required placeholder=\"Your full name\" /></div>
                <div><label class=\"notice\">Email</label><input required type=\"email\" placeholder=\"you@example.com\" /></div>
              </div>
              <div style=\"margin-top:10px;\"><label class=\"notice\">How would you like to help?</label>
                <select>${roleOptions}</select>
              </div>
              <div style=\"margin-top:10px;\"><label class=\"notice\">Message</label><textarea rows=\"4\" placeholder=\"Tell us a bit about yourself\"></textarea></div>
              <div style=\"margin-top:12px;\"><button type=\"submit\">Send</button></div>
            </form>
            <p class=\"notice\" style=\"margin-top:8px;\">Prefer email? Write to <a href=\"mailto:${volunteerEmail}\">${volunteerEmail}</a></p>
          </div>
          <div class=\"card\">
            <h3>Partner or refer</h3>
            <p>${esc(d.get_involved?.partner?.intro || 'We work with schools, faith groups, and local services. Refer a family or propose a joint activity.')}</p>
            <a class=\"btn\" href=\"mailto:${partnerEmail}?subject=Partnership%20enquiry\">Email us</a>
            <p class=\"notice\" style=\"margin-top:8px;\">${esc(d.get_involved?.partner?.note || 'We are based in West Glasgow. Meetings by appointment.')}</p>
          </div>
        </div>`;

      const news = document.getElementById('news');
      const newsCards = (d.news||[]).map(n=>`
        <div class=\"card\">
          <h3>${esc(n.title)}</h3>
          <p>${esc(n.body)}</p>
          ${n.date?`<p class=\"notice\">Posted: <time>${esc(n.date)}</time></p>`:''}
        </div>`).join('');
      news.innerHTML = `
        <div class=\"kicker\">Updates</div>
        <h2 class=\"section-title\">${esc(d.news_title || 'Latest news')}</h2>
        <div class=\"grid\">${newsCards}</div>`;

      const donate = document.getElementById('donate');
      const dlinks = [];
      if(d.donate?.paypal) dlinks.push(`<a class=\"btn\" href=\"${esc(d.donate.paypal)}\">Donate via PayPal</a>`);
      if(d.donate?.stripe) dlinks.push(`<a class=\"btn secondary\" href=\"${esc(d.donate.stripe)}\">Donate via Stripe</a>`);
      if(d.donate?.justgiving) dlinks.push(`<a class=\"pill\" href=\"${esc(d.donate.justgiving)}\">JustGiving page</a>`);
      donate.innerHTML = `
        <div class=\"kicker\">Donate</div>
        <h2 class=\"section-title\">${esc(d.donate_title || 'Support our work')}</h2>
        <p>${esc(d.donate?.intro || 'Your donation helps us run weekly food support, skills workshops, and safe community spaces.')}</p>
        <div class=\"donate-row\" style=\"margin:14px 0 6px;\">${dlinks.join('\n')}</div>
        <p class=\"notice\">${esc(d.donate?.note || '')}</p>`;

      const gal = document.getElementById('gallery');
      const gitems = (d.gallery?.images||[]).map(g=>`
        <figure class=\"gimg\">
          <img src=\"${esc(g.src)}\" alt=\"${esc(g.alt||'Photo')}\" loading=\"lazy\"/>
          ${g.caption?`<figcaption>${esc(g.caption)}</figcaption>`:''}
        </figure>
      `).join('');
      gal.innerHTML = `
        <div class=\"kicker\">${esc(d.gallery?.title || 'Photos')}</div>
        <h2 class=\"section-title\">${esc(d.gallery?.subtitle || 'A glimpse of life at Baraka')}</h2>
        <div class=\"gallery\">${gitems}</div>`;

      const contact = document.getElementById('contact');
      const fb = d.contact?.socials?.facebook ? `<a href=\"${esc(d.contact.socials.facebook)}\">Facebook</a>`:'';
      const ig = d.contact?.socials?.instagram ? `<a href=\"${esc(d.contact.socials.instagram)}\">Instagram</a>`:'';
      const wa = d.contact?.socials?.whatsapp ? `<a href=\"${esc(d.contact.socials.whatsapp)}\">WhatsApp</a>`:'';
      const socials = [fb,ig,wa].filter(Boolean).join(' · ');
      contact.innerHTML = `
        <div class=\"kicker\">Contact</div>
        <h2 class=\"section-title\">${esc(d.contact_title || 'Get in touch')}</h2>
        <div class=\"two\">
          <div class=\"card\">
            <h3>Message us</h3>
            <form action=\"mailto:${esc(d.contact?.email || '')}\" method=\"post\" enctype=\"text/plain\" onsubmit=\"alert('Thanks! We\\'ll reply soon.');\">
              <div class=\"two\">
                <div><label class=\"notice\">Name</label><input required placeholder=\"Your name\" /></div>
                <div><label class=\"notice\">Email</label><input required type=\"email\" placeholder=\"you@example.com\" /></div>
              </div>
              <div style=\"margin-top:10px;\"><label class=\"notice\">Your message</label><textarea rows=\"4\" placeholder=\"How can we help?\"></textarea></div>
              <div style=\"margin-top:12px;\"><button type=\"submit\">Send</button></div>
            </form>
            ${d.contact?.email ? `<p class=\"notice\" style=\"margin-top:8px;\">Email: <a href=\"mailto:${esc(d.contact.email)}\">${esc(d.contact.email)}</a></p>`:''}
          </div>
          <div class=\"card\">
            <h3>Visit</h3>
            <p>${esc(d.contact?.visit_note || 'West Glasgow (meetings by appointment). Exact address shared upon confirmation for safeguarding.')}</p>
            ${d.contact?.map_embed || ''}
            ${socials?`<p class=\"notice\">Follow us: ${socials}</p>`:''}
          </div>
        </div>`;

      document.getElementById('year').textContent = new Date().getFullYear();
      if(d.site?.name) document.getElementById('footerName').textContent = d.site.name;
      if(d.legal?.scio) document.getElementById('scio').textContent = d.legal.scio;
      if(d.legal?.oscr_badge) document.getElementById('oscrBadge').src = d.legal.oscr_badge;
    }

    (function runTests(){
      try {
        assert('esc() escapes &', esc('&') === '&amp;');
        assert('esc() escapes < and >', esc('<>') === '&lt;&gt;');
        assert('esc() escapes "', esc('"') === '&quot;');
        assert('esc() handles null/undefined', esc(null) === '');
        const fallback = parseDefault();
        assert('default-content JSON is an object', typeof fallback === 'object' && !!fallback);
        renderSite({site:{brand:{bg:'#ABCDEF'},name:'X'}, hero:{title:'T',lead:'L',actions:[],stats:[]}, about:{}, programmes:[], get_involved:{}, news:[], donate:{}, gallery:{images:[]}, contact:{}, legal:{}});
        const bg = getComputedStyle(document.documentElement).getPropertyValue('--bg').trim();
        assert('brand.bg sets --bg', bg === '#ABCDEF');
        renderSite({site:{name:'X'}, hero:{title:'T',lead:'L',actions:[],stats:[]}, about:{}, programmes:[], get_involved:{}, news:[], donate:{}, gallery:{images:[{src:'assets/baraka-logo.png'}]}, contact:{}, legal:{}});
        assert('gallery renders images', document.querySelectorAll('#gallery img').length === 1);
        renderSite({site:{name:'X'}, hero:{title:'T',lead:'L',actions:[],stats:[]}, about:{}, programmes:[{title:'P', image:'assets/baraka-logo.png'}], get_involved:{}, news:[], donate:{}, gallery:{images:[]}, contact:{}, legal:{}});
        assert('programme image renders', document.querySelectorAll('.prog-img').length === 1);
        const dlinks = ['<a>1</a>','<a>2</a>'];
        const html = `<div>${dlinks.join('\n')}</div>`;
        assert('join("\\n") does not break template', html.includes('\n'));
        renderSite({site:{name:'Baraka Test'}, hero:{title:'T',lead:'L',actions:[],stats:[]}, about:{}, programmes:[], get_involved:{}, news:[], donate:{}, gallery:{images:[]}, contact:{}, legal:{}});
        assert('siteName updated', document.getElementById('siteName').textContent === 'Baraka Test');
        const cardColor = getComputedStyle(document.documentElement).getPropertyValue('--card').trim();
        assert('tinted card variable exists', !!cardColor && cardColor.startsWith('#'));
      } catch(err){ results.push('✘ Test harness error: '+ err.message); }
      finally { finish(); }
    })();
    loadContent();
  </script>
</body>
</html>
